<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      function service() {
        this.name = name;
      }
      service.prototype = {
        constructor: service,
        timeout: async function () {
          return new Promise((resolve, reject) => {
            let result = timeout(() => {
              alert("timeout");
            }, 1000);
            return result;
          });
        },
        makeAlert: function () {
          alert("asd");
        },
      };

      function view() {
        this.makeButton();
        this.makeInput();
        this.btn = document.getElementById("submit-btn");
        this.put = document.getElementById("js-input").value;
      }
      view.prototype = {
        constructor: view,
        makeInput: function () {
          let input = document.createElement("input");
          input.type = "text";
          input.id = "js-input";
          document.body.appendChild(input);
        },
        makeImg: function () {
          let img = document.createElement("img");
          img.src = "images/cafe_main.jpg";
          //   document.body.append(img);
          document.body.appendChild(img);
        },

        makeButton: function () {
          let btn = document.createElement("input");
          btn.type = "submit";
          btn.id = "submit-btn";
          btn.value = "submit";
          document.body.appendChild(btn);
        },

        eventListen: function (callback) {
          this.btn.addEventListener("click", callback);
        },
      };

      function ctr(service, view) {
        var self = this;
        this.service = service;
        this.view = view;
        this.view.eventListen(this.test(self)); //생성자 함수 내에서 service접근 가능한데 프로토타입에서 undefined로 나옴
      }
      ctr.prototype = {
        constructor: ctr,

        controll: async function (scope) {
          let that = scope;
          try {
            console.log("this:" + that.service);
            let result = await that.service.timeout();
          } catch (e) {
            console.log("error: " + e);
          }
        },
        test: function (self) {
          let that = self;
          that.service.makeAlert();
        },
      };

      let CTR = new ctr(new service(), new view());
    </script>
  </body>
</html>
